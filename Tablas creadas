-- se crea el schema--
create schema aminchala

--se crea la tabla especialidad--
CREATE TABLE aminchala.especialidad (
    id_especialidad SERIAL PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL UNIQUE,
    descripcion TEXT,
    estado BOOLEAN DEFAULT TRUE,
    id_usuario_creacion INT,
    id_usuario_modificacion INT,
    f_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    f_modificacion TIMESTAMP
);

--se crea la tabla paciente--
CREATE TABLE aminchala.paciente (
    id_paciente SERIAL PRIMARY KEY,
    nombres VARCHAR(100) NOT NULL,
    apellidos VARCHAR(100) NOT NULL,
    cedula VARCHAR(20) NOT NULL UNIQUE,
    telefono VARCHAR(20),
    correo VARCHAR(150) UNIQUE,
    direccion TEXT,
    estado BOOLEAN DEFAULT TRUE,
    id_usuario_creacion INT,
    id_usuario_modificacion INT,
    f_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    f_modificacion TIMESTAMP
);

-- se crea la tabla medico--
CREATE TABLE aminchala.medico (
    id_medico SERIAL PRIMARY KEY,
    nombres VARCHAR(100) NOT NULL,
    apellidos VARCHAR(100) NOT NULL,
    telefono VARCHAR(20),
    correo VARCHAR(150) UNIQUE,
    id_especialidad INT NOT NULL,
    estado BOOLEAN DEFAULT TRUE,
    id_usuario_creacion INT,
    id_usuario_modificacion INT,
    f_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    f_modificacion TIMESTAMP,
    FOREIGN KEY (id_especialidad)
        REFERENCES aminchala.especialidad(id_especialidad)
);

-- se crea la tabla consultorio--
CREATE TABLE aminchala.consultorio (
    id_consultorio SERIAL PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    piso INT,
    descripcion TEXT,
    estado BOOLEAN DEFAULT TRUE,
    id_usuario_creacion INT,
    id_usuario_modificacion INT,
    f_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    f_modificacion TIMESTAMP
);

-- se crea la tabla cita--
CREATE TABLE aminchala.cita (
    id_cita SERIAL PRIMARY KEY,
    fecha DATE NOT NULL,
    hora TIME NOT NULL,
    estado_cita VARCHAR(50) NOT NULL,
    id_paciente INT NOT NULL,
    id_medico INT NOT NULL,
    id_consultorio INT NOT NULL,
    estado BOOLEAN DEFAULT TRUE,
    id_usuario_creacion INT,
    id_usuario_modificacion INT,
    f_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    f_modificacion TIMESTAMP,
    FOREIGN KEY (id_paciente)
        REFERENCES aminchala.paciente(id_paciente),
    FOREIGN KEY (id_medico)
        REFERENCES aminchala.medico(id_medico),
    FOREIGN KEY (id_consultorio)
        REFERENCES aminchala.consultorio(id_consultorio)
);

-- se crea la tabla historial medico--
CREATE TABLE aminchala.historial_medico (
    id_historial SERIAL PRIMARY KEY,
    diagnostico TEXT NOT NULL,
    tratamiento TEXT,
    observaciones TEXT,
    id_cita INT NOT NULL UNIQUE,
    estado BOOLEAN DEFAULT TRUE,
    id_usuario_creacion INT,
    id_usuario_modificacion INT,
    f_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    f_modificacion TIMESTAMP,
    FOREIGN KEY (id_cita)
        REFERENCES aminchala.cita(id_cita)
);
